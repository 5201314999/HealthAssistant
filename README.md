# 慢性病助手 - HarmonyOS 应用

## 📱 项目简介

这是一款基于 HarmonyOS 的慢性病助手应用，专注于慢性病助手和用药提醒功能。应用采用**灵活的模板系统架构**，支持轻松扩展更多慢性病助手功能。数据完全离线存储，无需服务器后端，保护用户隐私。

### 🌟 核心特性

- **🔧 灵活扩展** - 基于模板系统，添加新疾病无需修改代码
- **📊 动态表单** - 根据配置自动生成录入界面
- **💾 离线优先** - 所有数据本地存储，保护隐私
- **🎨 现代 UI** - Material Design 风格，清晰直观

## ✨ 功能特性

### 1. 高血压管理

- ✅ 血压数据录入（收缩压、舒张压）
- ✅ 自动判断血压水平（正常/正常高值/高血压）
- ✅ 历史数据列表查看
- ✅ 数据删除功能
- ✅ 备注信息记录

### 2. 糖尿病管理

- ✅ 血糖数据录入
  - 空腹血糖
  - 餐后 2 小时血糖
  - 睡前血糖
  - 随机血糖
- ✅ 糖化血红蛋白（HbA1c）记录
- ✅ 自动判断血糖水平（正常/异常/糖尿病范围）
- ✅ 历史数据查看和管理
- ✅ 分类统计展示

### 3. 甲亢管理

- ✅ 支持甲功三项数据录入（TSH、FT3、FT4）
- ✅ 支持甲功五项数据录入（TSH、FT3、FT4、TT3、TT4）
- ✅ 自动判断指标是否异常（基于标准参考值范围）
- ✅ 历史数据列表查看
- ✅ 数据删除功能
- ✅ 备注信息记录

### 4. 用药管理

- ✅ 药品信息管理
  - 药品名称、规格、用法用量
  - 服用时间设置（早、中、晚、睡前）
  - 用药周期设置
  - 库存数量管理
- ✅ 今日用药打卡
  - 自动生成每日用药记录
  - 勾选打卡功能
  - 统计已服用/待服用次数
  - 完成度百分比显示
- ✅ 用药提醒
  - 今日用药进度展示
  - 用药提醒列表
  - 我的用药列表

### 5. 首页功能

- ✅ 健康概览与今日用药切换
- ✅ 健康状态概览
  - 管理疾病数量统计
  - 最新血压数据展示
  - 最新血糖数据展示
- ✅ 疾病列表快速访问
- ✅ 底部导航栏（首页/用药/我的）

### 6. 个人中心

- ✅ 用户信息展示
- ✅ 统计数据
  - 管理疾病数量
  - 服用药品数量
  - 服药率百分比
- ✅ 快捷设置
  - 推送通知开关
  - 严格提醒开关
- ✅ 个人信息入口

## 🏗️ 技术架构

### 开发环境

- **操作系统**: HarmonyOS
- **SDK 版本**: 6.0.0(20)
- **开发语言**: ArkTS (TypeScript)
- **UI 框架**: ArkUI
- **构建工具**: Hvigor

### 项目结构

```
entry/src/main/ets/
├── models/                       # 数据模型
│   ├── DiseaseTemplate.ets      # 疾病模板定义（核心）
│   └── MedicineData.ets         # 药品数据模型
├── config/
│   └── BuiltInTemplates.ets     # 内置模板配置（高血压、糖尿病、甲亢）
├── utils/
│   ├── HealthDataManager.ets    # 通用健康数据管理器
│   └── NotificationManager.ets  # 通知管理器
├── pages/
│   ├── MainPage.ets             # 主导航页（底部Tab）
│   ├── HomePage.ets             # 首页（健康概览/今日用药）
│   ├── MedicineTabPage.ets      # 用药Tab页（用药提醒/我的用药）
│   ├── ProfilePage.ets          # 个人中心页
│   ├── DiseaseManagePage.ets    # 通用疾病管理页（适配所有疾病）
│   ├── DataEntryPage.ets        # 通用数据录入页（动态表单）
│   └── AddMedicinePage.ets      # 添加药品页
└── entryability/
    └── EntryAbility.ets         # 应用入口
```

**✨ 架构优势：**

- 2 个通用页面适配所有慢性病助手
- 添加新疾病只需配置模板，无需写代码
- 代码量减少 70%+，易于维护

## 💾 数据存储

应用使用 HarmonyOS 的 **Preferences** API 进行本地数据持久化：

- **存储位置**: 应用沙箱目录
- **存储格式**: JSON
- **存储策略**: 按模板 ID 分类存储
- **数据类型**:
  - `health_records_hypertension`: 高血压记录
  - `health_records_diabetes`: 糖尿病记录
  - `health_records_thyroid`: 甲亢记录
  - `health_records_*`: 其他疾病记录（可扩展）
  - `medicine_list`: 药品列表
  - `medicine_records`: 用药记录

## 📊 参考值标准

### 血压指标

| 类型   | 正常范围 | 正常高值  | 高血压 | 单位 |
| ------ | -------- | --------- | ------ | ---- |
| 收缩压 | 90 - 120 | 120 - 140 | ≥ 140  | mmHg |
| 舒张压 | 60 - 80  | 80 - 90   | ≥ 90   | mmHg |

### 血糖指标

| 类型         | 正常   | 糖尿病 | 单位   |
| ------------ | ------ | ------ | ------ |
| 空腹血糖     | < 6.1  | ≥ 7.0  | mmol/L |
| 餐后 2 小时  | < 7.8  | ≥ 11.1 | mmol/L |
| 糖化血红蛋白 | < 6.0% | -      | %      |

### 甲功指标

| 指标 | 参考范围   | 单位   |
| ---- | ---------- | ------ |
| TSH  | 0.27 - 4.2 | mIU/L  |
| FT3  | 3.1 - 6.8  | pmol/L |
| FT4  | 12 - 22    | pmol/L |
| TT3  | 1.3 - 3.1  | nmol/L |
| TT4  | 66 - 181   | nmol/L |

## 🚀 运行方式

### 前置条件

1. 安装 DevEco Studio
2. 配置 HarmonyOS SDK 6.0.0(20) 或更高版本
3. 准备 HarmonyOS 设备或模拟器

### 运行步骤

1. 在 DevEco Studio 中打开项目
2. 等待依赖安装完成
3. 连接 HarmonyOS 设备或启动模拟器
4. 点击运行按钮

## 🎨 UI 设计特点

- **现代化设计**: 采用卡片式布局，清晰直观
- **底部导航**: 首页、用药、我的三个主要功能入口
- **Tab 切换**: 健康概览/今日用药、用药提醒/我的用药
- **颜色体系**:
  - 主题色：蓝色 (#4A90E2)
  - 高血压管理：红色主题 (#EF5350)
  - 糖尿病管理：橙色主题 (#FFA726)
  - 甲亢管理：绿色主题 (#4CAF50)
- **数据可视化**:
  - 健康数据卡片展示
  - 环形进度条显示服药率
  - 异常数据红色标注，正常数据绿色显示
- **交互友好**: 一键录入、快捷操作、即时反馈

## 🔐 隐私保护

- ✅ **完全离线**: 所有数据存储在本地，不上传服务器
- ✅ **数据隔离**: 使用应用沙箱机制，数据仅应用可访问
- ✅ **无网络权限**: 应用不申请任何网络相关权限

## 📝 使用说明

### 录入甲功数据

1. 首页点击"甲亢管理"
2. 选择"录入甲功三项"或"录入甲功五项"
3. 填写检查报告中的数据
4. 系统自动判断是否异常

### 录入血糖数据

1. 首页点击"糖尿病管理"
2. 选择血糖类型（空腹/餐后/睡前/随机）
3. 输入血糖值
4. 查看健康状态评估

### 添加用药

1. 首页点击"用药管理" → "药品列表"
2. 点击"添加药品"
3. 填写药品信息和服用时间
4. 设置用药周期
5. 系统自动生成每日用药提醒

### 用药打卡

1. 在"今日用药"页面查看待服用药品
2. 勾选已服用的药品进行打卡
3. 系统记录实际服用时间

## 🔄 扩展新疾病模板

得益于灵活的模板系统，您可以轻松添加新的慢性病助手功能：

### 添加步骤

1. 在 `config/BuiltInTemplates.ets` 中创建模板
2. 定义疾病指标和参考值
3. 注册到模板列表

**就这么简单！** 详见 [`TEMPLATE_GUIDE.md`](TEMPLATE_GUIDE.md)

### 可扩展的疾病模板

- ✅ 高血压管理（已内置）
- ✅ 糖尿病管理（已内置）
- ✅ 甲亢管理（已内置）
- 🔧 高血脂管理（可扩展）
- 🔧 哮喘管理（可扩展）
- 🔧 痛风管理（可扩展）
- 🔧 心脏病管理（可扩展）
- 🔧 肾病管理（可扩展）
- 🔧 ...更多疾病

## 🔄 未来功能规划

- [ ] 数据导出功能（PDF/Excel）
- [ ] 图表趋势展示
- [ ] 用药提醒通知
- [ ] 数据备份到云端
- [ ] 多用户管理
- [ ] 自定义模板编辑器
- [ ] AI 健康建议

## 📚 文档

- [README.md](README.md) - 项目介绍
- [ARCHITECTURE.md](ARCHITECTURE.md) - 架构设计详解
- [TEMPLATE_GUIDE.md](TEMPLATE_GUIDE.md) - 模板扩展指南

## 📄 许可证

本项目仅供学习和个人使用。

## ⚠️ 免责声明

本应用提供的参考值和健康评估仅供参考，不能替代医生的专业诊断。如有健康问题，请及时就医。

1. 新增类型，不要用字面量类型， 都需要 interface 声名类型再使用
2. any ，unknow 不允许
3. const e =ErrorUtils.toError(err)
   hilog.error(DOMAIN, TAG, 'Init failed:%{public}s', JSON.stringify(e));
   throw e; throw error 参考这种写法
4. 不需要编写文档文件，说明文档
5. Only UI component syntax can be written here
